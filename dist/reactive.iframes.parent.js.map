{"version":3,"sources":["reactive.iframes.parent.ts"],"names":["reactive","reactive.iframes","reactive.iframes.Parent","reactive.iframes.Parent.constructor","reactive.iframes.Parent.sendWidth","reactive.iframes.Parent.sendMessage","reactive.iframes.Parent.makeMessage","reactive.iframes.Parent.iframe","reactive.iframes.Parent.processMessage"],"mappings":"AACA,IAAO,QAAQ,CA6Dd;AA7DD,WAAO,QAAQ;IAACA,IAAAA,OAAOA,CA6DtBA;IA7DeA,WAAAA,OAAOA,EAACA,CAACA;QAErBC,IAAMA,aAAaA,GAAGA,iBAAiBA,CAACA;QACxCA,IAAMA,gBAAgBA,GAAGA,GAAGA,CAACA;QAE7BA;YAMIC,gBAAoBA,OAAoBA,EAAUA,EAAUA,EAAUA,SAAkBA;gBAN5FC,iBAsDCA;gBAhDuBA,YAAOA,GAAPA,OAAOA,CAAaA;gBAAUA,OAAEA,GAAFA,EAAEA,CAAQA;gBAAUA,cAASA,GAATA,SAASA,CAASA;gBAMhFA,aAAQA,GAAGA,UAACA,KAAYA;oBAC5BA,KAAIA,CAACA,SAASA,EAAEA,CAACA;gBACrBA,CAACA,CAAAA;gBAPGA,MAAMA,CAACA,gBAAgBA,CAACA,QAAQA,EAAEA,IAAIA,CAACA,QAAQA,CAACA,CAACA;gBACjDA,IAAIA,CAACA,YAAYA,GAAGA,IAAIA,MAAMA,CAACA,GAAGA,GAAGA,aAAaA,GAAGA,gBAAgBA,GAAGA,EAAEA,GAAGA,gBAAgBA,GAAGA,QAAQA,GAAGA,gBAAgBA,GAAGA,OAAOA,CAACA,CAACA;gBACvIA,MAAMA,CAACA,gBAAgBA,CAACA,SAASA,EAAEA,IAAIA,CAACA,cAAcA,CAACA,IAAIA,CAACA,IAAIA,CAACA,EAAEA,KAAKA,CAACA,CAACA;YAC9EA,CAACA;YAMDD,0BAASA,GAATA;gBACIE,IAAIA,KAAKA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,WAAWA,CAACA,QAAQA,EAAEA,CAACA;gBAChDA,IAAIA,CAACA,WAAWA,CAACA,OAAOA,EAAEA,KAAKA,CAACA,CAACA;YACrCA,CAACA;YAEDF,4BAAWA,GAAXA,UAAYA,WAAmBA,EAAEA,OAAeA;gBAC5CG,IAAIA,CAACA,MAAMA,CAACA,aAAaA,CAACA,WAAWA,CAACA,IAAIA,CAACA,WAAWA,CAACA,WAAWA,EAAEA,OAAOA,CAACA,EAAEA,GAAGA,CAACA,CAACA;YACvFA,CAACA;YAEOH,4BAAWA,GAAnBA,UAAoBA,WAAmBA,EAAEA,OAAeA;gBACpDI,IAAIA,IAAIA,GAAGA,CAACA,aAAaA,EAAEA,IAAIA,CAACA,EAAEA,EAAEA,WAAWA,EAAEA,OAAOA,CAACA,CAACA;gBAC1DA,MAAMA,CAACA,IAAIA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA;YACvCA,CAACA;YAEDJ,sBAAIA,0BAAMA;qBAAVA;oBACIK,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,oBAAoBA,CAACA,QAAQA,CAACA,CAACA,CAACA,CAACA,CAACA;gBAC1DA,CAACA;;;eAAAL;YAEDA,+BAAcA,GAAdA,UAAeA,KAAYA;gBACvBM,EAAEA,CAACA,CAACA,CAACA,CAACA,KAAKA,YAAYA,YAAYA,CAACA,IAAIA,OAAqBA,KAAKA,CAACA,IAAIA,KAAKA,QAAQA,CAACA,CAACA,CAACA;oBACnFA,MAAMA,CAACA;gBACXA,CAACA;gBACDA,IAAIA,WAAWA,GAA0BA,KAAMA,CAACA,IAAIA,CAACA;gBAErDA,IAAIA,KAAKA,GAAGA,WAAWA,CAACA,KAAKA,CAACA,IAAIA,CAACA,YAAYA,CAACA,CAACA;gBACjDA,EAAEA,CAACA,CAACA,CAACA,KAAKA,IAAIA,KAAKA,CAACA,MAAMA,KAAKA,CAACA,CAACA,CAACA,CAACA;oBAACA,MAAMA,CAACA;gBAACA,CAACA;gBAE7CA,IAAIA,GAAGA,GAAGA,KAAKA,CAACA,CAACA,CAACA,CAACA;gBACnBA,IAAIA,KAAKA,GAAGA,KAAKA,CAACA,CAACA,CAACA,CAACA;gBACrBA,EAAEA,CAACA,CAACA,GAAGA,KAAKA,QAAQA,CAACA,CAACA,CAACA;oBACnBA,IAAIA,MAAMA,GAAGA,QAAQA,CAACA,KAAKA,CAACA,CAACA;oBAC7BA,EAAEA,CAACA,CAACA,IAAIA,CAACA,SAASA,CAACA,CAACA,CAACA;wBACjBA,MAAMA,IAAIA,IAAIA,CAACA,SAASA,CAACA;oBAC7BA,CAACA;oBACDA,OAAOA,CAACA,GAAGA,CAACA,WAAWA,GAAGA,MAAMA,GAAGA,aAAaA,GAAGA,IAAIA,CAACA,EAAEA,GAAGA,GAAGA,CAACA,CAACA;oBAClEA,IAAIA,CAACA,MAAMA,CAACA,YAAYA,CAACA,QAAQA,EAAEA,MAAMA,GAAGA,IAAIA,CAACA,CAACA;gBACtDA,CAACA;YACLA,CAACA;YACLN,aAACA;QAADA,CAtDAD,AAsDCC,IAAAD;QAtDYA,cAAMA,SAsDlBA,CAAAA;IAELA,CAACA,EA7DeD,OAAOA,GAAPA,gBAAOA,KAAPA,gBAAOA,QA6DtBA;AAADA,CAACA,EA7DM,QAAQ,KAAR,QAAQ,QA6Dd","file":"reactive.iframes.parent.js","sourcesContent":["\r\nmodule reactive.iframes {\r\n    \r\n    const MessagePrefix = 'ReactiveIFrames';\r\n    const MessageDelimiter = '~';\r\n\r\n    export class Parent {\r\n\r\n        url: string\r\n        config: any\r\n        messageRegex: RegExp\r\n\r\n        constructor(private element: HTMLElement, private id: string, private addHeight?: number) {\r\n            window.addEventListener('resize', this.onResize);\r\n            this.messageRegex = new RegExp('^' + MessagePrefix + MessageDelimiter + id + MessageDelimiter + '(\\\\S+)' + MessageDelimiter + '(.+)$');\r\n            window.addEventListener('message', this.processMessage.bind(this), false);\r\n        }\r\n        \r\n        private onResize = (event: Event) => {\r\n            this.sendWidth();\r\n        }\r\n\r\n        sendWidth() {\r\n            var width = this.element.offsetWidth.toString();\r\n            this.sendMessage('width', width);\r\n        }\r\n\r\n        sendMessage(messageType: string, message: string) {\r\n            this.iframe.contentWindow.postMessage(this.makeMessage(messageType, message), '*');\r\n        }\r\n\r\n        private makeMessage(messageType: string, message: string) {\r\n            var bits = [MessagePrefix, this.id, messageType, message];\r\n            return bits.join(MessageDelimiter);\r\n        }\r\n\r\n        get iframe() {\r\n            return this.element.getElementsByTagName('iframe')[0];\r\n        }\r\n\r\n        processMessage(event: Event) {\r\n            if (!(event instanceof MessageEvent) || typeof <MessageEvent>event.data !== 'string') {\r\n                return;\r\n            }\r\n            var messageData = <string>(<MessageEvent>event).data;\r\n\r\n            var match = messageData.match(this.messageRegex);\r\n            if (!match || match.length !== 3) { return; }\r\n\r\n            var key = match[1];\r\n            var value = match[2];\r\n            if (key === 'height') {\r\n                var height = parseInt(value);\r\n                if (this.addHeight) {\r\n                    height += this.addHeight;\r\n                }\r\n                console.log(\"Child -> \" + height + \" H Parent (\" + this.id + \")\");\r\n                this.iframe.setAttribute('height', height + 'px');\r\n            }\r\n        }\r\n    }\r\n\r\n}"],"sourceRoot":"/source/"}